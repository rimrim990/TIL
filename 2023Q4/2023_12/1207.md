# TIL - 2023.12.07 (목)
## 도커

### 가상머신과 도커 컨테이너

**사용 이유**

가상머신과 도커 컨테이너를 사용하는 이유는 무엇일까?
이것들을 사용해 서로 다른 물리적 서버에 동일한 실행 환경을 구성할 수 있다. (ex. JVM)
- 필요한 라이브러리들과 버전을 고정해 패키징한 이미지로 배포한다
- 배포 시점과 실행 시점에 상관없이 항상 동일한 환경을 구성할 수 있다

**가상머신**

가상머신은 **하이퍼아비저**를 통해 **여러 운영체제를 하나의 호스트 운영체제**에서 사용한다.
- 하이퍼바이저는 게스트 OS를 생성하고 실행하는 프로세스이다
- 각 가상머신에는 우분투, CentOS 등의 게스트 운영체제가 설치되어 실행된다
- 게스트 운영체제는 다른 게스트 운영체제와 독립된 공간과 자원을 할당받는다
- 호스트 OS - 하이퍼바이저 - 게스트 OS를 거쳐야 하는 오버헤드가 존재한다

가상머신은 가상화된 CPU, 메모리, 스토리지, 네트워크 인터페이스 등의 할당된 자원을 각 가상머신에 제공한다.

가상머신 이미지는 게스트 운영체제 사용을 위한 커널도 포함하기 때문에 크기가 크다.
- 가상머신 이미지의 크기는 수 기가 바이트 정도 된다

<img width="500" src="https://github.com/rimrim990/TIL/assets/62409503/33dd6f14-e66f-4805-b871-40f61238382a">

**도커**

도커는 격리된 환경의 프로세스를 생성한다.
- 도커 컨테이너는 호스트 커널을 공유해 사용한다

컨테이너 이미지는 애플리케이션 실행에 필요한 라이브러리와 실행 파일만 포함한다.
- 가상머신에 비해 크기가 대폭 줄어든다
- 가상머신보다 빠르게 배포할 수 있다

도커 컨테이너는 호스트 커널을 공유한다.
- 도커 컨테이너를 실행하려면 호스트가 특정 CPU 아키텍처 혹은 운영체제를 사용해야 한다
- ARM 계열의 아키텍처 플랫폼에서는 x86 아키텍처에서 빌드한 도커 컨테이너를 실행할 수 없다

도커는 리눅스 환경에 최적화되어있다. 
- `Docker for MAC`이나 `Docker for Windows`를 설치하면 **리눅스 환경 구축을 위해 가상화 기술**을 사용한다

```shell
$ docker image inspect hello
[{
  "Architecture": "arm64",
  "Os": "linux"
}]
```
- `Docker for MAC`이 설치된 맥 OS 환경에서 빌드된 이미지 정보를 출력하였다
- `Architecture`는 `arm64` 였지만, `OS`는 리눅스로 출력되었다
